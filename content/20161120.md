Title: Glowscript 測試
Date: 2016-11-20 15:00
Category: Misc
Tags: 使用導引, 期中, 
Author: yen

Glowscript 測試

<!-- PELICAN_END_SUMMARY -->

<script type="text/javascript" src="./theme/js/jquery.min.js">
</script>
<script type="text/javascript" src="./theme/js/glow.2.2.min.js">
</script>

<!-- 導入 Brython 標準程式庫 -->
<script type="text/javascript" 
    src="https://cdn.rawgit.com/brython-dev/brython/master/www/src/brython_dist.js">
</script>
<!-- 啟動 Brython -->
<script>
window.onload=function(){
brython(1);
}
</script>
<!-- 以下實際利用  Brython 執行繪圖 -->
<div id="glowscript" class="glowscript"></div>

<script type="text/python3">

from browser import document as doc
from browser import window

class glow:
  def __init__(self, container):
      self._id=doc.get(id=container)[0]
      setattr(self._id, 'id', '')

      setattr(window, '__context', {})
      setattr(getattr(window, '__context'), 'glowscript_container', self._id.elt)
      
      self._glowscript=window.glowscript

  def canvas(self):
      return self._glowscript.canvas()

  def box(self):
      return self._glowscript.box()

  def vec(self, i, j, k):
      return self._glowscript.vec(i,j,k)

  def rate(self, t, func):
      self._glowscript.rate(t, func)

#converts a python dictionary to a javascript object with attributes
def dict2object(d):
    class foo:
       pass

    _obj=foo()
    _str=[]
    for _key, _value in d.items():
        _str.append("_obj.%s=%s" % (_key, _value))

    eval(';'.join(_str))
    return _obj

## below this line is the "real" application for this page

_gs=glow('glowscript')
_scene=_gs.canvas()      #is this needed?  we don't use it.
_box=_gs.box()

class foo:
  pass

_obj=foo()
_obj.angle=0.01
_obj.axis=_gs.vec(0,1,0)

def spin():
    #_box.rotate(_obj)    # <==  this doesn't work!
    #the line below doesn't work either.. an issue with dict2object
    #_box.rotate(dict2object({'angle': 0.01, 'axis': _gs.vec(0,1,0}))

    _box.rotate(dict2object({'angle': 0.01}))  # <==  this works!
    _gs.rate(100, spin)  # make spin a callback       

spin()
</script>
